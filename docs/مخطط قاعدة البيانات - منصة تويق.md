# مخطط قاعدة البيانات - منصة تويق

يعتمد مشروع تويق على قاعدة بيانات SQLite بشكل افتراضي، ويستخدم RedBeanPHP ORM لإدارة الجداول والعلاقات. يتم تعريف مخطط قاعدة البيانات بشكل ضمني من خلال استدعاءات `R::dispense()` في ملف `database/Database.php`.

فيما يلي وصف للجداول الرئيسية والحقول المتوقعة بناءً على الكود المصدري:

## الجداول

### 1. `users` (المستخدمون)

يخزن معلومات المستخدمين المسجلين في النظام.

| الحقل            | النوع     | الوصف                                  | ملاحظات                                   |
|------------------|----------|----------------------------------------|--------------------------------------------|
| `id`             | INTEGER  | المعرف الفريد للمستخدم                 | مفتاح أساسي، زيادة تلقائية                |
| `username`       | TEXT     | اسم المستخدم الفريد                    |                                            |
| `email`          | TEXT     | البريد الإلكتروني للمستخدم             |                                            |
| `password`       | TEXT     | كلمة المرور المشفرة                    |                                            |
| `fullname`       | TEXT     | الاسم الكامل للمستخدم                  |                                            |
| `bio`            | TEXT     | نبذة تعريفية عن المستخدم               |                                            |
| `avatar`         | TEXT     | مسار صورة الملف الشخصي                 |                                            |
| `cover_image`    | TEXT     | مسار صورة الغلاف                       |                                            |
| `location`       | TEXT     | موقع المستخدم                          |                                            |
| `website`        | TEXT     | رابط الموقع الشخصي للمستخدم            |                                            |
| `is_verified`    | BOOLEAN  | هل المستخدم موثق؟                      | 0 (لا) أو 1 (نعم)                         |
| `is_active`      | BOOLEAN  | هل الحساب نشط؟                         | 0 (غير نشط) أو 1 (نشط)                    |
| `created_at`     | DATETIME | تاريخ ووقت إنشاء الحساب                |                                            |
| `updated_at`     | DATETIME | تاريخ ووقت آخر تحديث للحساب            |                                            |

### 2. `tweets` (التغريدات)

يخزن التغريدات التي ينشرها المستخدمون.

| الحقل            | النوع     | الوصف                                  | ملاحظات                                   |
|------------------|----------|----------------------------------------|--------------------------------------------|
| `id`             | INTEGER  | المعرف الفريد للتغريدة                 | مفتاح أساسي، زيادة تلقائية                |
| `user_id`        | INTEGER  | معرف المستخدم الذي نشر التغريدة        | مفتاح خارجي يشير إلى `users.id`            |
| `content`        | TEXT     | محتوى التغريدة                         |                                            |
| `image_url`      | TEXT     | مسار الصورة المرفقة بالتغريدة          | يمكن أن يكون `NULL`                       |
| `likes_count`    | INTEGER  | عدد الإعجابات بالتغريدة                | القيمة الافتراضية 0                       |
| `retweets_count` | INTEGER  | عدد إعادة التغريدات                    | القيمة الافتراضية 0                       |
| `replies_count`  | INTEGER  | عدد الردود على التغريدة                | القيمة الافتراضية 0                       |
| `created_at`     | DATETIME | تاريخ ووقت إنشاء التغريدة              |                                            |
| `updated_at`     | DATETIME | تاريخ ووقت آخر تحديث للتغريدة          |                                            |

### 3. `follows` (المتابعات)

يسجل علاقات المتابعة بين المستخدمين.

| الحقل            | النوع     | الوصف                                  | ملاحظات                                   |
|------------------|----------|----------------------------------------|--------------------------------------------|
| `id`             | INTEGER  | المعرف الفريد لعلاقة المتابعة          | مفتاح أساسي، زيادة تلقائية                |
| `follower_id`    | INTEGER  | معرف المستخدم الذي يتابع               | مفتاح خارجي يشير إلى `users.id`            |
| `following_id`   | INTEGER  | معرف المستخدم الذي يتم متابعته         | مفتاح خارجي يشير إلى `users.id`            |
| `created_at`     | DATETIME | تاريخ ووقت بدء المتابعة                |                                            |

### 4. `likes` (الإعجابات)

يسجل إعجابات المستخدمين بالتغريدات.

| الحقل            | النوع     | الوصف                                  | ملاحظات                                   |
|------------------|----------|----------------------------------------|--------------------------------------------|
| `id`             | INTEGER  | المعرف الفريد للإعجاب                  | مفتاح أساسي، زيادة تلقائية                |
| `user_id`        | INTEGER  | معرف المستخدم الذي أعجب                 | مفتاح خارجي يشير إلى `users.id`            |
| `tweet_id`       | INTEGER  | معرف التغريدة التي تم الإعجاب بها      | مفتاح خارجي يشير إلى `tweets.id`           |
| `created_at`     | DATETIME | تاريخ ووقت الإعجاب                     |                                            |

### 5. `sessions` (الجلسات)

يخزن معلومات جلسات المستخدمين.

| الحقل            | النوع     | الوصف                                  | ملاحظات                                   |
|------------------|----------|----------------------------------------|--------------------------------------------|
| `id`             | INTEGER  | المعرف الفريد للجلسة                   | مفتاح أساسي، زيادة تلقائية                |
| `user_id`        | INTEGER  | معرف المستخدم المرتبط بالجلسة          | مفتاح خارجي يشير إلى `users.id`            |
| `session_token`  | TEXT     | رمز الجلسة الفريد                      |                                            |
| `expires_at`     | DATETIME | تاريخ ووقت انتهاء صلاحية الجلسة        |                                            |
| `created_at`     | DATETIME | تاريخ ووقت إنشاء الجلسة                |                                            |

### 6. `replies` (الردود)

يخزن الردود على التغريدات.

| الحقل            | النوع     | الوصف                                  | ملاحظات                                   |
|------------------|----------|----------------------------------------|--------------------------------------------|
| `id`             | INTEGER  | المعرف الفريد للرد                     | مفتاح أساسي، زيادة تلقائية                |
| `tweet_id`       | INTEGER  | معرف التغريدة التي تم الرد عليها       | مفتاح خارجي يشير إلى `tweets.id`           |
| `user_id`        | INTEGER  | معرف المستخدم الذي قام بالرد           | مفتاح خارجي يشير إلى `users.id`            |
| `content`        | TEXT     | محتوى الرد                             |                                            |
| `image_url`      | TEXT     | مسار الصورة المرفقة بالرد              | يمكن أن يكون `NULL`                       |
| `likes_count`    | INTEGER  | عدد الإعجابات بالرد                    | القيمة الافتراضية 0                       |
| `replies_count`  | INTEGER  | عدد الردود على هذا الرد                | القيمة الافتراضية 0                       |
| `created_at`     | DATETIME | تاريخ ووقت إنشاء الرد                  |                                            |
| `updated_at`     | DATETIME | تاريخ ووقت آخر تحديث للرد              |                                            |

### 7. `replylikes` (إعجابات الردود)

يسجل إعجابات المستخدمين بالردود.

| الحقل            | النوع     | الوصف                                  | ملاحظات                                   |
|------------------|----------|----------------------------------------|--------------------------------------------|
| `id`             | INTEGER  | المعرف الفريد لإعجاب الرد              | مفتاح أساسي، زيادة تلقائية                |
| `reply_id`       | INTEGER  | معرف الرد الذي تم الإعجاب به           | مفتاح خارجي يشير إلى `replies.id`          |
| `user_id`        | INTEGER  | معرف المستخدم الذي أعجب                 | مفتاح خارجي يشير إلى `users.id`            |
| `created_at`     | DATETIME | تاريخ ووقت الإعجاب                     |                                            |

### 8. `tweet_lists` (قوائم التغريدات)

يخزن القوائم المخصصة التي ينشئها المستخدمون لتنظيم التغريدات أو المستخدمين.

| الحقل            | النوع     | الوصف                                  | ملاحظات                                   |
|------------------|----------|----------------------------------------|--------------------------------------------|
| `id`             | INTEGER  | المعرف الفريد للقائمة                  | مفتاح أساسي، زيادة تلقائية                |
| `user_id`        | INTEGER  | معرف المستخدم الذي أنشأ القائمة        | مفتاح خارجي يشير إلى `users.id`            |
| `name`           | TEXT     | اسم القائمة                            |                                            |
| `description`    | TEXT     | وصف القائمة                            |                                            |
| `is_private`     | BOOLEAN  | هل القائمة خاصة؟                       | 0 (عامة) أو 1 (خاصة)                      |
| `cover_image`    | TEXT     | مسار صورة غلاف القائمة                 | يمكن أن يكون `NULL`                       |
| `members_count`  | INTEGER  | عدد الأعضاء في القائمة                 | القيمة الافتراضية 0                       |
| `created_at`     | DATETIME | تاريخ ووقت إنشاء القائمة               |                                            |
| `updated_at`     | DATETIME | تاريخ ووقت آخر تحديث للقائمة           |                                            |

### 9. `list_members` (أعضاء القائمة)

يسجل المستخدمين الأعضاء في القوائم المخصصة.

| الحقل            | النوع     | الوصف                                  | ملاحظات                                   |
|------------------|----------|----------------------------------------|--------------------------------------------|
| `id`             | INTEGER  | المعرف الفريد لعضو القائمة             | مفتاح أساسي، زيادة تلقائية                |
| `list_id`        | INTEGER  | معرف القائمة                           | مفتاح خارجي يشير إلى `tweet_lists.id`      |
| `user_id`        | INTEGER  | معرف المستخدم العضو                    | مفتاح خارجي يشير إلى `users.id`            |
| `created_at`     | DATETIME | تاريخ ووقت إضافة العضو                 |                                            |

### 10. `events` (الأحداث)

يخزن معلومات الأحداث التي ينشئها المستخدمون.

| الحقل            | النوع     | الوصف                                  | ملاحظات                                   |
|------------------|----------|----------------------------------------|--------------------------------------------|
| `id`             | INTEGER  | المعرف الفريد للحدث                    | مفتاح أساسي، زيادة تلقائية                |
| `user_id`        | INTEGER  | معرف المستخدم الذي أنشأ الحدث          | مفتاح خارجي يشير إلى `users.id`            |
| `title`          | TEXT     | عنوان الحدث                            |                                            |
| `description`    | TEXT     | وصف الحدث                              |                                            |
| `event_type`     | TEXT     | نوع الحدث (مثال: general, public)      |                                            |
| `start_time`     | DATETIME | تاريخ ووقت بدء الحدث                   |                                            |
| `end_time`       | DATETIME | تاريخ ووقت انتهاء الحدث                |                                            |
| `is_live`        | BOOLEAN  | هل الحدث مباشر؟                        | 0 (لا) أو 1 (نعم)                         |
| `image_url`      | TEXT     | مسار صورة الحدث                        | يمكن أن يكون `NULL`                       |
| `participants_count`| INTEGER  | عدد المشاركين في الحدث                 | القيمة الافتراضية 0                       |
| `location`       | TEXT     | موقع الحدث                             |                                            |
| `hashtags`       | TEXT     | الهاشتاجات المرتبطة بالحدث             | مفصولة بفاصلة أو مسافة                    |
| `created_at`     | DATETIME | تاريخ ووقت إنشاء الحدث                 |                                            |
| `updated_at`     | DATETIME | تاريخ ووقت آخر تحديث للحدث             |                                            |

### 11. `event_participants` (المشاركون في الحدث)

يسجل المستخدمين المشاركين في الأحداث.

| الحقل            | النوع     | الوصف                                  | ملاحظات                                   |
|------------------|----------|----------------------------------------|--------------------------------------------|
| `id`             | INTEGER  | المعرف الفريد للمشارك                  | مفتاح أساسي، زيادة تلقائية                |
| `event_id`       | INTEGER  | معرف الحدث                             | مفتاح خارجي يشير إلى `events.id`           |
| `user_id`        | INTEGER  | معرف المستخدم المشارك                  | مفتاح خارجي يشير إلى `users.id`            |
| `joined_at`      | DATETIME | تاريخ ووقت انضمام المستخدم للحدث       |                                            |

### 12. `user_settings` (إعدادات المستخدم)

يخزن تفضيلات وإعدادات كل مستخدم.

| الحقل            | النوع     | الوصف                                  | ملاحظات                                   |
|------------------|----------|----------------------------------------|--------------------------------------------|
| `id`             | INTEGER  | المعرف الفريد للإعدادات                | مفتاح أساسي، زيادة تلقائية                |
| `user_id`        | INTEGER  | معرف المستخدم                          | مفتاح خارجي يشير إلى `users.id`            |
| `profile_visibility`| TEXT     | خصوصية الملف الشخصي (public, private) |                                            |
| `tweet_privacy`  | TEXT     | خصوصية التغريدات (public, private)    |                                            |
| `message_privacy`| TEXT     | خصوصية الرسائل (everyone, followers)  |                                            |
| `tagging_permission`| TEXT     | إذن الإشارة (everyone, followers, none)|                                            |
| `location_sharing`| BOOLEAN  | مشاركة الموقع؟                         | 0 (لا) أو 1 (نعم)                         |
| `photo_tagging`  | BOOLEAN  | إذن الإشارة في الصور؟                  | 0 (لا) أو 1 (نعم)                         |
| `search_by_email`| BOOLEAN  | السماح بالبحث بالبريد الإلكتروني؟      | 0 (لا) أو 1 (نعم)                         |
| `search_by_phone`| BOOLEAN  | السماح بالبحث بالهاتف؟                 | 0 (لا) أو 1 (نعم)                         |
| `email_notifications`| BOOLEAN  | إشعارات البريد الإلكتروني؟             | 0 (لا) أو 1 (نعم)                         |
| `push_notifications`| BOOLEAN  | إشعارات الدفع؟                         | 0 (لا) أو 1 (نعم)                         |
| `sms_notifications`| BOOLEAN  | إشعارات الرسائل القصيرة؟              | 0 (لا) أو 1 (نعم)                         |
| `like_notifications`| BOOLEAN  | إشعارات الإعجابات؟                     | 0 (لا) أو 1 (نعم)                         |
| `reply_notifications`| BOOLEAN  | إشعارات الردود؟                        | 0 (لا) أو 1 (نعم)                         |
| `follow_notifications`| BOOLEAN  | إشعارات المتابعة؟                      | 0 (لا) أو 1 (نعم)                         |
| `mention_notifications`| BOOLEAN  | إشعارات الإشارة؟                       | 0 (لا) أو 1 (نعم)                         |
| `retweet_notifications`| BOOLEAN  | إشعارات إعادة التغريد؟                | 0 (لا) أو 1 (نعم)                         |
| `message_notifications`| BOOLEAN  | إشعارات الرسائل؟                       | 0 (لا) أو 1 (نعم)                         |
| `theme`          | TEXT     | المظهر (light, dark)                   |                                            |
| `font_size`      | TEXT     | حجم الخط (small, medium, large)       |                                            |
| `language`       | TEXT     | اللغة (ar, en)                         |                                            |
| `timezone`       | TEXT     | المنطقة الزمنية                        |                                            |
| `autoplay_videos`| BOOLEAN  | تشغيل الفيديو تلقائيًا؟                | 0 (لا) أو 1 (نعم)                         |
| `data_saver`     | BOOLEAN  | وضع توفير البيانات؟                    | 0 (لا) أو 1 (نعم)                         |
| `high_quality_images`| BOOLEAN  | صور عالية الجودة؟                     | 0 (لا) أو 1 (نعم)                         |
| `sensitive_content`| BOOLEAN  | إخفاء المحتوى الحساس؟                  | 0 (لا) أو 1 (نعم)                         |
| `two_factor_auth`| BOOLEAN  | المصادقة الثنائية؟                     | 0 (لا) أو 1 (نعم)                         |
| `login_verification`| BOOLEAN  | التحقق عند تسجيل الدخول؟               | 0 (لا) أو 1 (نعم)                         |
| `password_reset_email`| BOOLEAN  | إرسال بريد عند إعادة تعيين كلمة المرور؟| 0 (لا) أو 1 (نعم)                         |
| `created_at`     | DATETIME | تاريخ ووقت إنشاء الإعدادات             |                                            |
| `updated_at`     | DATETIME | تاريخ ووقت آخر تحديث للإعدادات         |                                            |

### 13. `conversations` (المحادثات)

يخزن معلومات المحادثات بين المستخدمين.

| الحقل            | النوع     | الوصف                                  | ملاحظات                                   |
|------------------|----------|----------------------------------------|--------------------------------------------|
| `id`             | INTEGER  | المعرف الفريد للمحادثة                 | مفتاح أساسي، زيادة تلقائية                |
| `participant_one`| INTEGER  | معرف المشارك الأول                     | مفتاح خارجي يشير إلى `users.id`            |
| `participant_two`| INTEGER  | معرف المشارك الثاني                    | مفتاح خارجي يشير إلى `users.id`            |
| `created_at`     | DATETIME | تاريخ ووقت إنشاء المحادثة              |                                            |
| `updated_at`     | DATETIME | تاريخ ووقت آخر تحديث للمحادثة          |                                            |

### 14. `messages` (الرسائل)

يخزن الرسائل ضمن المحادثات.

| الحقل            | النوع     | الوصف                                  | ملاحظات                                   |
|------------------|----------|----------------------------------------|--------------------------------------------|
| `id`             | INTEGER  | المعرف الفريد للرسالة                  | مفتاح أساسي، زيادة تلقائية                |
| `conversation_id`| INTEGER  | معرف المحادثة                          | مفتاح خارجي يشير إلى `conversations.id`    |
| `sender_id`      | INTEGER  | معرف المرسل                            | مفتاح خارجي يشير إلى `users.id`            |
| `content`        | TEXT     | محتوى الرسالة                          |                                            |
| `message_type`   | TEXT     | نوع الرسالة (text, image, video)       |                                            |
| `is_read`        | BOOLEAN  | هل الرسالة مقروءة؟                     | 0 (لا) أو 1 (نعم)                         |
| `created_at`     | DATETIME | تاريخ ووقت إرسال الرسالة               |                                            |

### 15. `reels` (المقاطع)

يخزن معلومات مقاطع الفيديو القصيرة (Reels).

| الحقل            | النوع     | الوصف                                  | ملاحظات                                   |
|------------------|----------|----------------------------------------|--------------------------------------------|
| `id`             | INTEGER  | المعرف الفريد للمقطع                   | مفتاح أساسي، زيادة تلقائية                |
| `user_id`        | INTEGER  | معرف المستخدم الذي أنشأ المقطع         | مفتاح خارجي يشير إلى `users.id`            |
| `title`          | TEXT     | عنوان المقطع                           |                                            |
| `description`    | TEXT     | وصف المقطع                             |                                            |
| `video_url`      | TEXT     | مسار ملف الفيديو                       |                                            |
| `thumbnail_url`  | TEXT     | مسار صورة المعاينة (thumbnail)         |                                            |
| `duration`       | INTEGER  | مدة المقطع بالثواني                    |                                            |
| `views_count`    | INTEGER  | عدد المشاهدات                         | القيمة الافتراضية 0                       |
| `likes_count`    | INTEGER  | عدد الإعجابات                         | القيمة الافتراضية 0                       |
| `comments_count` | INTEGER  | عدد التعليقات                          | القيمة الافتراضية 0                       |
| `hashtags`       | TEXT     | الهاشتاجات المرتبطة بالمقطع            | مفصولة بفاصلة أو مسافة                    |
| `music_title`    | TEXT     | عنوان الموسيقى المستخدمة               |                                            |
| `music_artist`   | TEXT     | فنان الموسيقى المستخدمة                |                                            |
| `is_public`      | BOOLEAN  | هل المقطع عام؟                         | 0 (خاص) أو 1 (عام)                        |
| `created_at`     | DATETIME | تاريخ ووقت إنشاء المقطع                |                                            |
| `updated_at`     | DATETIME | تاريخ ووقت آخر تحديث للمقطع            |                                            |

### 16. `reel_likes` (إعجابات المقاطع)

يسجل إعجابات المستخدمين بالمقاطع.

| الحقل            | النوع     | الوصف                                  | ملاحظات                                   |
|------------------|----------|----------------------------------------|--------------------------------------------|
| `id`             | INTEGER  | المعرف الفريد لإعجاب المقطع            | مفتاح أساسي، زيادة تلقائية                |
| `reel_id`        | INTEGER  | معرف المقطع الذي تم الإعجاب به         | مفتاح خارجي يشير إلى `reels.id`            |
| `user_id`        | INTEGER  | معرف المستخدم الذي أعجب                 | مفتاح خارجي يشير إلى `users.id`            |
| `created_at`     | DATETIME | تاريخ ووقت الإعجاب                     |                                            |

### 17. `reel_comments` (تعليقات المقاطع)

يخزن التعليقات على المقاطع.

| الحقل            | النوع     | الوصف                                  | ملاحظات                                   |
|------------------|----------|----------------------------------------|--------------------------------------------|
| `id`             | INTEGER  | المعرف الفريد للتعليق                  | مفتاح أساسي، زيادة تلقائية                |
| `reel_id`        | INTEGER  | معرف المقطع الذي تم التعليق عليه       | مفتاح خارجي يشير إلى `reels.id`            |
| `user_id`        | INTEGER  | معرف المستخدم الذي قام بالتعليق        | مفتاح خارجي يشير إلى `users.id`            |
| `content`        | TEXT     | محتوى التعليق                          |                                            |
| `likes_count`    | INTEGER  | عدد الإعجابات بالتعليق                 | القيمة الافتراضية 0                       |
| `created_at`     | DATETIME | تاريخ ووقت إنشاء التعليق               |                                            |

### 18. `reel_views` (مشاهدات المقاطع)

يسجل مشاهدات المستخدمين للمقاطع.

| الحقل            | النوع     | الوصف                                  | ملاحظات                                   |
|------------------|----------|----------------------------------------|--------------------------------------------|
| `id`             | INTEGER  | المعرف الفريد للمشاهدة                 | مفتاح أساسي، زيادة تلقائية                |
| `reel_id`        | INTEGER  | معرف المقطع الذي تم مشاهدته            | مفتاح خارجي يشير إلى `reels.id`            |
| `user_id`        | INTEGER  | معرف المستخدم الذي شاهد                | مفتاح خارجي يشير إلى `users.id`            |
| `view_duration`  | INTEGER  | مدة المشاهدة بالثواني                  |                                            |
| `created_at`     | DATETIME | تاريخ ووقت المشاهدة                    |                                            |

**ملاحظة**: RedBeanPHP يقوم بإنشاء الجداول والحقول تلقائيًا بناءً على أول عملية `dispense` و `store` لكل نوع من الكائنات. هذا المخطط يعكس الهيكل المتوقع بناءً على استخدام `dispense` في `Database.php`.

