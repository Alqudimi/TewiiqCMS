# إعدادات التطبيق - منصة تويق

تعتمد منصة تويق على ملفات إعدادات ومتغيرات بيئة لتحديد سلوك التطبيق، الاتصال بقاعدة البيانات، وإعدادات الميزات المختلفة. يتم تحميل هذه الإعدادات من ملف `.env` ومن ملفات الإعدادات في مجلد `config/`.

## 1. ملف `.env` (متغيرات البيئة)

يحتوي ملف `.env` على إعدادات حساسة أو خاصة بالبيئة التي يعمل فيها التطبيق. يتم قراءته بواسطة مكتبة `vlucas/phpdotenv`.

| المتغير             | الوصف                                        | القيم المحتملة / أمثلة                               |
|--------------------|----------------------------------------------|------------------------------------------------------|
| `APP_NAME`         | اسم التطبيق                                  | `"تويق"`                                             |
| `APP_ENV`          | بيئة التطبيق (تطوير، إنتاج)                   | `production`, `development`                          |
| `APP_DEBUG`        | تفعيل وضع التصحيح (يعرض الأخطاء)             | `true`, `false`                                      |
| `APP_URL`          | عنوان URL الأساسي للتطبيق                    | `http://localhost:80`, `https://yourdomain.com`      |
| `DB_CONNECTION`    | نوع اتصال قاعدة البيانات                     | `sqlite`, `mysql`, `pgsql`                           |
| `DB_DATABASE`      | مسار ملف قاعدة بيانات SQLite أو اسم قاعدة بيانات MySQL/PostgreSQL | `./database/tewiiq.db`                               |
| `SESSION_LIFETIME` | مدة صلاحية الجلسة بالدقائق                   | `120` (دقيقتان)                                      |
| `SESSION_SECURE`   | هل يجب أن تكون الجلسة آمنة (HTTPS فقط)؟      | `true`, `false`                                      |
| `UPLOAD_MAX_SIZE`  | أقصى حجم للملفات المرفوعة (مثال: 10M)        | `10M`, `50M`                                         |
| `ALLOWED_EXTENSIONS`| امتدادات الملفات المسموح بها للرفع           | `jpg,jpeg,png,gif,mp4,mov,avi`                       |
| `MAIL_MAILER`      | نوع مرسل البريد الإلكتروني                    | `smtp`, `sendmail`, `log`                            |
| `MAIL_HOST`        | خادم SMTP                                    | `smtp.gmail.com`                                     |
| `MAIL_PORT`        | منفذ SMTP                                    | `587`, `465`                                         |
| `MAIL_USERNAME`    | اسم مستخدم البريد الإلكتروني                  | `your-email@gmail.com`                               |
| `MAIL_PASSWORD`    | كلمة مرور البريد الإلكتروني                   | `your-password`                                      |
| `MAIL_ENCRYPTION`  | نوع التشفير للبريد الإلكتروني                 | `tls`, `ssl`, `null`                                 |

**مثال لملف `.env`:**

```ini
APP_NAME="تويق"
APP_ENV=production
APP_DEBUG=false
APP_URL=http://localhost:80

DB_CONNECTION=sqlite
DB_DATABASE=./database/tewiiq.db

SESSION_LIFETIME=120
SESSION_SECURE=false

UPLOAD_MAX_SIZE=10M
ALLOWED_EXTENSIONS=jpg,jpeg,png,gif,mp4,mov,avi

MAIL_MAILER=smtp
MAIL_HOST=smtp.gmail.com
MAIL_PORT=587
MAIL_USERNAME=your-email@gmail.com
MAIL_PASSWORD=your-password
MAIL_ENCRYPTION=tls
```

## 2. ملف `config/app.php` (إعدادات التطبيق العامة)

يحتوي هذا الملف على إعدادات عامة للتطبيق يمكن تعديلها لتخصيص سلوك المنصة. (يجب إنشاء هذا الملف يدويًا إذا لم يكن موجودًا).

| الإعداد               | الوصف                                        | القيم المحتملة / أمثلة                               |
|----------------------|----------------------------------------------|------------------------------------------------------|
| `site_name`          | اسم الموقع المعروض في الواجهة الأمامية       | `'تويق'`                                             |
| `site_description`   | وصف موجز للموقع                             | `'منصة التواصل الاجتماعي العربية'`                    |
| `timezone`           | المنطقة الزمنية الافتراضية للتطبيق           | `'Asia/Riyadh'`, `'UTC'`                             |
| `locale`             | اللغة الافتراضية للتطبيق                     | `'ar'`, `'en'`                                       |
| `max_tweet_length`   | أقصى طول مسموح به للتغريدة                   | `280`                                                |
| `max_file_size`      | أقصى حجم للملفات المرفوعة بالبايت            | `10 * 1024 * 1024` (10 ميجابايت)                     |
| `allowed_file_types` | أنواع الملفات المسموح بها للرفع              | `['jpg', 'jpeg', 'png', 'gif', 'mp4']`               |
| `features`           | مصفوفة تحتوي على مفاتيح لتفعيل/تعطيل الميزات |                                                      |
| `features.registration_open` | هل التسجيل مفتوح للمستخدمين الجدد؟     | `true`, `false`                                      |
| `features.email_verification` | هل يتطلب التحقق من البريد الإلكتروني؟  | `true`, `false`                                      |
| `features.reels_enabled` | هل ميزة المقاطع (Reels) مفعلة؟         | `true`, `false`                                      |
| `features.events_enabled` | هل ميزة الأحداث مفعلة؟                 | `true`, `false`                                      |
| `features.lists_enabled` | هل ميزة القوائم مفعلة؟                 | `true`, `false`                                      |
| `features.messages_enabled` | هل ميزة الرسائل مفعلة؟                | `true`, `false`                                      |

**مثال لملف `config/app.php`:**

```php
<?php
return [
    'site_name' => 'تويق',
    'site_description' => 'منصة التواصل الاجتماعي العربية',
    'timezone' => 'Asia/Riyadh',
    'locale' => 'ar',
    'max_tweet_length' => 280,
    'max_file_size' => 10 * 1024 * 1024, // 10MB
    'allowed_file_types' => ['jpg', 'jpeg', 'png', 'gif', 'mp4'],
    'features' => [
        'registration_open' => true,
        'email_verification' => false,
        'reels_enabled' => true,
        'events_enabled' => true,
        'lists_enabled' => true,
        'messages_enabled' => true,
    ]
];
```

## 3. إعدادات المستخدم (User Settings)

يتم تخزين إعدادات المستخدم الفردية في جدول `user_settings` في قاعدة البيانات. يمكن للمستخدمين تعديل هذه الإعدادات من خلال واجهة المستخدم.

(راجع توثيق مخطط قاعدة البيانات `database-schema.md` للحصول على تفاصيل حول حقول جدول `user_settings`).

## كيفية الوصول إلى الإعدادات

يمكن الوصول إلى متغيرات البيئة من خلال `$_ENV` بعد تحميلها بواسطة `phpdotenv`. أما الإعدادات في `config/app.php` فيمكن الوصول إليها عن طريق تضمين الملف وقراءة المصفوفة العائدة منه.

