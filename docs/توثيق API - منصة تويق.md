# توثيق API - منصة تويق

يوفر مشروع تويق بعض نقاط النهاية (API Endpoints) للتفاعل مع بيانات التطبيق بشكل برمجي. هذه الواجهات تستخدم بشكل أساسي من قبل الواجهة الأمامية للتطبيق، ولكن يمكن استخدامها لأغراض التكامل أو التطوير.

## نقاط النهاية المتاحة

### 1. البحث عن المستخدمين

- **المسار**: `/api/users/search`
- **النوع**: `GET`
- **الوصف**: يسمح بالبحث عن المستخدمين بناءً على اسمهم الكامل أو اسم المستخدم.
- **معاملات الاستعلام (Query Parameters)**:
  - `q` (مطلوب): سلسلة البحث. يجب أن تكون بطول حرفين على الأقل.
- **الاستجابة (Response)**:
  - `200 OK`:
    ```json
    {
      "users": [
        {
          "id": 1,
          "fullname": "اسم المستخدم الكامل",
          "username": "username",
          "avatar": "مسار_صورة_الملف_الشخصي"
        }
      ]
    }
    ```
  - إذا كانت سلسلة البحث أقصر من حرفين، يتم إرجاع قائمة مستخدمين فارغة.

### 2. جلب الرسائل (API)

- **المسار**: `/messages/api`
- **النوع**: `GET`
- **الوصف**: يستخدم لجلب الرسائل في محادثة معينة. (يتطلب مصادقة المستخدم).
- **معاملات الاستعلام (Query Parameters)**:
  - لا توجد معاملات استعلام محددة في الكود، ولكن من المتوقع أن يعتمد على جلسة المستخدم لتحديد المحادثة.
- **الاستجابة (Response)**:
  - `200 OK`: قائمة بالرسائل.
  - `401 Unauthorized`: إذا لم يكن المستخدم مصادقًا.

### 3. جلب إعدادات المستخدم (API)

- **المسار**: `/settings/api`
- **النوع**: `GET`
- **الوصف**: يستخدم لجلب إعدادات المستخدم الحالية. (يتطلب مصادقة المستخدم).
- **معاملات الاستعلام (Query Parameters)**:
  - لا توجد.
- **الاستجابة (Response)**:
  - `200 OK`: كائن JSON يحتوي على إعدادات المستخدم.
  - `401 Unauthorized`: إذا لم يكن المستخدم مصادقًا.

## المصادقة

تعتمد نقاط النهاية التي تتطلب معلومات المستخدم (مثل `/messages/api` و `/settings/api`) على جلسة المستخدم الحالية. هذا يعني أن المستخدم يجب أن يكون قد قام بتسجيل الدخول مسبقًا وأن تكون جلسة PHP نشطة.

## ملاحظات للمطورين

- **معالجة الأخطاء**: يتم التعامل مع الأخطاء الأساسية (مثل 404) في الراوتر الرئيسي. بالنسبة لأخطاء API، يجب على الواجهة الأمامية التعامل مع استجابات HTTP المختلفة.
- **الأمان**: تأكد من أن جميع الطلبات التي تتطلب بيانات حساسة أو تعديلات تتم عبر `POST` أو `PUT` أو `DELETE` وأنها محمية بشكل مناسب (على سبيل المثال، باستخدام رموز CSRF إذا كان التطبيق يدعمها، أو التحقق من الجلسة).
- **توسيع API**: يمكن إضافة المزيد من نقاط النهاية في مجلد `controllers/` وتوجيهها في `public/index.php` لتوفير وظائف API إضافية.

